      subroutine sreal_proc_res(p,legs,chan,wgt)
      implicit none
      include "nexternal.inc"
      include "coupl.inc"
      double precision p(0:3,nexternal),wgt
      integer legs(nexternal),lstr
      character*4 chan
      character*140 str

      call convert_to_string(nexternal,legs,str,lstr)

#ifdef DEBUGQ
      print*
      print*, "[DEBUG] str = ", str
      !print*, "p1",p(0:3,1)
      !print*, "p2",p(0:3,2)
      !print*, "p3",p(0:3,3)
      !print*, "p4",p(0:3,4)
      !print*, "p5",p(0:3,5)
      !print*, "legs",legs
      print*, chan,wgt
#endif
      
      ! here: only left handed squarks can become resonant
      if( chan.ne."ul35" .and. chan.ne."ul45" .and. 
     &    chan.ne."dl35" .and. chan.ne."dl45") then
        print*,"wrong channel number: ", chan
        print*,"choose ul35, ul45, dl35, dl45."
        stop
      endif

      wgt = 0D0
      if(str.eq."101000022-10000242") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000022-1000024-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000022-1000024-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000022-10000244") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000022-10000242") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000022-1000024-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000022-1000024-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000022-10000244") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000221000024-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100002210000241") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100002210000243") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000221000024-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000221000024-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100002210000241") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100002210000243") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000221000024-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
         
      elseif(str.eq."101000023-10000242") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000023-1000024-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000023-1000024-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000023-10000244") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000023-10000242") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000023-1000024-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000023-1000024-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000023-10000244") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000231000024-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100002310000241") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100002310000243") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000231000024-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000231000024-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100002310000241") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100002310000243") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000231000024-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
         
      elseif(str.eq."101000022-10000372") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000022-1000037-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000022-1000037-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000022-10000374") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000022-10000372") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000022-1000037-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000022-1000037-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000022-10000374") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000221000037-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100002210000371") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100002210000373") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000221000037-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000221000037-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100002210000371") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100002210000373") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000221000037-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
         
      elseif(str.eq."101000023-10000372") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000023-1000037-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000023-1000037-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000023-10000374") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000023-10000372") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000023-1000037-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000023-1000037-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000023-10000374") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000231000037-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100002310000371") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100002310000373") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000231000037-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000231000037-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100002310000371") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100002310000373") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000231000037-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      
      elseif(str.eq."101000025-10000242") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000025-1000024-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000025-1000024-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000025-10000244") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000025-10000242") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000025-1000024-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000025-1000024-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000025-10000244") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000251000024-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100002510000241") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100002510000243") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000251000024-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000251000024-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100002510000241") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100002510000243") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000251000024-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
         
      elseif(str.eq."101000025-10000372") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000025-1000037-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000025-1000037-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000025-10000374") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000025-10000372") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000025-1000037-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000025-1000037-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000025-10000374") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000251000037-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100002510000371") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100002510000373") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000251000037-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000251000037-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100002510000371") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100002510000373") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000251000037-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
         
      elseif(str.eq."101000035-10000242") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000035-1000024-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000035-1000024-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000035-10000244") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000035-10000242") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000035-1000024-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000035-1000024-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000035-10000244") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000351000024-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100003510000241") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100003510000243") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000351000024-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000351000024-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100003510000241") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100003510000243") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000351000024-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
         
      elseif(str.eq."101000035-10000372") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-201000035-1000037-1") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-401000035-1000037-3") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UXG_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."301000035-10000374") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DG_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."011000035-10000372") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-21000035-1000037-1") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-41000035-1000037-3") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GUX_NIXJDX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."031000035-10000374") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GD_NIXJU_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-1010000351000037-2") then
         !call srealmtrx_002(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."20100003510000371") then
         !call srealmtrx_004(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."40100003510000373") then
         !call srealmtrx_006(p,wgt)
         call SMATRIX_UG_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."-3010000351000037-4") then
         !call srealmtrx_008(p,wgt)
         call SMATRIX_DXG_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-110000351000037-2") then
         !call srealmtrx_009(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."02100003510000371") then
         !call srealmtrx_010(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."04100003510000373") then
         !call srealmtrx_011(p,wgt)
         call SMATRIX_GU_NIXJD_RES(p,chan,wgt)
         goto 20
      elseif(str.eq."0-310000351000037-4") then
         !call srealmtrx_012(p,wgt)
         call SMATRIX_GDX_NIXJUX_RES(p,chan,wgt)
         goto 20
      else
        wgt = 0d0
      endif
      
 20   continue

      ! cut obvious small weights
      if(dsqrt(wgt).lt.1D-30) then
        wgt = 0D0
      endif

#ifdef DEBUGQ
      print*,"str, chan, wgt: ",trim(str)," ",chan,wgt
#endif

      return
      end
